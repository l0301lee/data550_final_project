# Lung Cancer Data Analysis Project

## Overview

This project analyzes the "Lung Cancer Data" to identify potential risk factors for lung cancer, visualize data relationships, and build a predictive model to understand lung cancer likelihood in patients. The analysis includes:
- Data loading and preprocessing
- Descriptive statistics and tables
- Visualizations
- Logistic regression modeling

## Directory Structure

- `code/`: Contains scripts for each step of the analysis.
    - `01_data_preprocessing.R`: Loads and preprocesses the data, saving a cleaned dataset in the `output/` folder.
    - `02_descriptive_analysis.R`: Generates descriptive statistics (Table 1) and saves the table as an HTML file in `output/`.
    - `03_plot_age_distribution.R`: Creates a plot of age distribution by lung cancer status and saves it as a PNG file in `output/`.
    - `04_predictive_modeling.R`: Fits a logistic regression model and saves the results as an HTML file in `output/`.
- `data/`: Contains the lung cancer dataset (`lung_cancer_data.csv`). If privacy is a concern, use a synthetic or subset dataset.
- `output/`: Contains generated outputs:
    - `lung_data_clean.rds`: Cleaned version of the dataset.
    - `table1.html`: Descriptive statistics table.
    - `age_distribution.png`: Age distribution plot.
    - `model_summary.html`: Logistic regression results table.
- `report/`: Contains the `final_report.Rmd` file for generating the final report.

## Requirements

- **R** and the following R packages:
  - `dplyr`, `ggplot2`, `knitr`, `kableExtra`, `tableone`, `broom`, `here`, and `htmltools`.
- **Docker** (optional): For containerized execution of this project.

To ensure reproducibility, the project uses the `renv` package to manage R package dependencies.


```r
install.packages(c("dplyr", "ggplot2", "knitr", "kableExtra", "tableone", "broom", "here", "htmltools"))
```

## How to Set Up the Environment

1. **Clone the Repository**
   ```bash
   git clone https://github.com/l0301lee/data550_final_project
   cd data550_final_project
   ```
   
2. **Install R Package Dependencies**
   The project uses the `renv` package to ensure reporducibility. To restore the required R packages:
   ```bash
   make install
   ```
   This will use the `renv.lock` file to recreate the exact R package environment needed to run the project.

## Docker Image Instructions

1. **Build the Docker Image**
  To build the Docker image locally:
  docker build -t <your-dockerhub-username>/<your-project-name> .
  Alternatively, pull the prebuilt image from DockerHub:
  docker pull l0301lee/final

2. **Generate the Report**
  To generate the report, run the following command:
  
  make docker_run
  
  This command:
  - Runs the containerized R environment using the Docker image that was pre-built.
  - Mounts your local `report/` directory to the container.
  - Generates the report (`final_report.html`) and places it in the `report/` directory.

3. **Link to DockerHub**

  The Docker image is available at:
  https://hub.docker.com/r/l0301lee/final


## How to Generate the Report

1. **Clone the Repository**
   ```bash
   git clone https://github.com/l0301lee/data550_final_project
   cd data550_final_project
   ```

2. **Install Dependencies**
   Ensure you have R installed and the required packages, as outlined above.

3. **Generate the Report with `make`**
   Run the following command in your terminal to build the report:
   ```bash
   make
   ```

   The `make` command will:
   - Execute each script in `code/` to generate the necessary output files in `output/`.
   - Render the final report (`final_report.html`) by reading these saved outputs.

4. **View the Report**
   The final report will be available at `report/final_report.html`. Open this file in a web browser to view the results.

## Key Components in the Report

- **Table 1**: A summary of patient characteristics by lung cancer status, generated by `02_descriptive_analysis.R` and saved as `table1.html`.
- **Figure**: Age distribution by lung cancer status, created by `03_plot_age_distribution.R` and saved as `age_distribution.png`.
- **Logistic Regression Model**: Results for lung cancer prediction, created by `04_predictive_modeling.R` and saved as `model_summary.html`.

## Notes

- The `htmltools::includeHTML` function is used in `final_report.Rmd` to embed HTML tables in the report.
